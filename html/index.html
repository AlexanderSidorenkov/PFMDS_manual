<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PFMDS: PFMDS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PFMDS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PFMDS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Parallel Fortran Molecular Dynamics Simulation</h2>
<p>"Real Programmers use FORTRAN."</p>
<p>"If you can’t do it in FORTRAN, do it in assembly language. If you can’t do it in assembly language, it isn’t worth doing."</p>
<p>(Ed Post, Datamation Volume 29 number 7 July 1983)</p>
<h2>Что это?</h2>
<p>Это набор программ для молекулярной динамики (МД), подгона потенциалов и анализа результатов.</p>
<p>Поддерживается OpenMP параллелизм. Несколько независимых прогонов МД могут быть запущены параллельно с помощью MPI.</p>
<h2>Как скачать?</h2>
<p>Исходники и скомпилированные .exe для Windows можно скачать по ссылке <a href="https://github.com/AlexanderSidorenkov/PFMDS/archive/stable.zip">стабильная версия</a>. Или здесь: <a href="https://github.com/AlexanderSidorenkov/PFMDS/tree/stable">https://github.com/AlexanderSidorenkov/PFMDS/tree/stable</a> , зеленая кнопка Clone or Download.</p>
<h2>Документация</h2>
<p>Скачиваем описание <a href="https://github.com/AlexanderSidorenkov/PFMDS_manual/archive/master.zip">отсюда</a>. Разархивируем и жмем на documentation. Просмотр с помощью браузера.</p>
<h2>Список программ:</h2>
<h3>run_md_simulation и run_md_simulation_mpi</h3>
<p>Моделирование методом МД.</p>
<p>Потенциалы:</p>
<ul>
<li>Леннарда-Джонса (между двумя группами атомов и внутри одной) - lj, lj1g</li>
<li>модифицированный Леннарда-Джонса c косинусом (графен - металл) - ljc</li>
<li>модифицированный Морзе c косинусом (графен - металл) - morsec</li>
<li>Розато-Жиллопа-Легранда для металлов (один тип атомов) - rjl</li>
<li>Терсоффа-Бреннера (углерод) - tb</li>
<li>REBO (углерод, только подсчет энергии, сил нет) - rebosc</li>
</ul>
<p>Интеграторы:</p>
<ul>
<li>Верле в скоростной форме - nve</li>
<li>Верле в скоростной форме с цепочкой термостатов Нозе-Гувера (пока возможно применение только одной цепочки) - nvt</li>
<li>Молекулярная статика - nvms</li>
</ul>
<h3>run_gr_moire_fitting</h3>
<p>Подгон параметров модифицированных потенциалов Леннарда-Джонса или Морзе.</p>
<h3>run_gr_analysis</h3>
<p>Анализ расположения графена на поверхности меди.</p>
<h2>Дополнительный софт</h2>
<h3>Компилятор</h3>
<ul>
<li>ifort</li>
</ul>
<p>Работает без проблем (проверено на кластере Ломоносов-1), но с gfortran программа получается быстрее, это вопрос оптимизации.</p>
<ul>
<li>gfortran</li>
</ul>
<p>В gfortran версии 4.4 есть баг при аллокации omp private массивов в параллельной части программы. Рекомендуется использовать более поздние версии (проверено с gcc version 6.3.0).</p>
<h3>Просмотр .xyz файлов</h3>
<p>Для информации о атомах в вычислительной ячейки испльзован формат .xyz (<a href="http://libatoms.github.io/QUIP/io.html#module-ase.io.extxyz">http://libatoms.github.io/QUIP/io.html#module-ase.io.extxyz</a>). Просматривать можно, например, с помощью <a href="https://ovito.org">OVITO</a>.</p>
<h2>Как компилировать?</h2>
<p>На Linux запустить скрипт unix_bash_compile.sh в папке code_source. На Windows запустить скрипт windows_compile.cmd в папке code_source.</p>
<p>Изменить испльзуемый компилятор, путь к нему, опции компиляции и т. д. можно внутри этих скриптов.</p>
<p>Исполняемые файлы появятся в папке executables.</p>
<h2>Как запуситить моделирование?</h2>
<p>Исполняемые файлы в папке executables - результат компиляции программ в папке code_source/runnes, в которых вызываются необходимые подпрограммы. Для запуска моделирования достаточно использовать программу run_md_simulation или run_md_simulation_mpi.</p>
<h3>Запуск run_md_simulation:</h3>
<p>Запускает программу МД на одном процессоре (вычислительном узле). Если указан список файлов настроек, то будет по очереди запущено несколько прогонов.</p>
<p>Опции run_md_simulation. В скобках указаны значения по умолчанию.</p>
<p>-i,&ndash;input (md_run_settings.txt) Имя файла настроек.</p>
<p>-p,&ndash;prefix () Префикс выходных файлов.</p>
<p>-op,&ndash;out_period (1) Период вывода в шагах МД.</p>
<p>-omp_n,&ndash;openmp_threads_num (максимальное количество потоков) Количество OpenMP потоков.</p>
<p>-ipath,&ndash;input_path () Путь к папке с входными файлами</p>
<p>-ilist,&ndash;input_list () Имя файла со списком файлов настроек.</p>
<p>-opath,&ndash;out_path () Путь к папке с выходными файлами.</p>
<p>-ofile,&ndash;all_out_file (all_out.txt) Имя файла для общего вывода нескольких прогонов.</p>
<h3>Запуск run_md_simulation_mpi:</h3>
<p>Запускает программу МД на нескольких процессорах (вычислительных узлах). Если указан список файлов настроек, то несколько прогонов будут распределены между доступными узлами (количество прогонов должно быть равно или больше количества вычислительных узлов). Если список не указан, то один прогон будет независимо запущен на всех узлах.</p>
<p>run_md_simulation_mpi имеет те же опции, что и run_md_simulation</p>
<h3>Входные файлы</h3>
<h4>Файл настроек</h4>
<p>Имеет фиксированный порядок строк и переменных в строках, который определяется порядком чтения в <a class="el" href="namespacemd__simulation.html#a2ecb7414f23418d07af30f1a8b21678a" title="Молекулярная динамика. ">md()</a>.</p>
<p>Названия параметров в файле настроек не проверяются при чтении. Единственное что важно, это порядок!</p>
<p>Пример:</p>
<p>Двухкомпонентный Л-Дж газ из атомов A и B.</p>
<p>Сначала проводится моделирование при постоянной температуре, потом при постоянной энергии, потом все охаждается до 0 К молекулярной статикой.</p>
<div class="fragment"><div class="line">md_step_limit:              1000000</div><div class="line">logfilename:                md_run.log</div><div class="line">init_xyz_filename:          AB.xyz</div><div class="line">new_velocities:             T</div><div class="line">zero_momentum_period:       1000000</div><div class="line">particle_types_num:         2</div><div class="line">groups_num:                 4</div><div class="line">    1       A   B   </div><div class="line">    2       A   #   </div><div class="line">    3       B   #   </div><div class="line">    4       #   #   </div><div class="line">all_moving_atoms_group_num:     1</div><div class="line">xyz_moving_atoms_group_num:     1</div><div class="line">z_moving_atoms_group_num:       4</div><div class="line">termo_atoms_group_num:      1</div><div class="line">all_atoms_group_num:        1</div><div class="line">traj_group_num:             3</div><div class="line">period_traj:                200</div><div class="line">change_group_num:           0</div><div class="line">invert_z_vel:               F</div><div class="line">integrators_num:            3</div><div class="line"> name    dt         len     snap     log</div><div class="line"> nvt     0.50000    10000   500000    1000</div><div class="line"> nve     0.50000    10000   500000    1000</div><div class="line"> nvms    0.50000    10000   500000    1000</div><div class="line">ms_de:                      1.e-8</div><div class="line">nhc_params:                 100.    3   10000.</div><div class="line">initial_temerature:         100.</div><div class="line">interactions_num:           3</div><div class="line">lj      parameters_LJ_A-B.txt</div><div class="line">2   3   8       7.5     20</div><div class="line">3   2   64      7.5     20</div><div class="line">lj1g    parameters_LJ_A-A.txt</div><div class="line">2   2   64      7.5     20</div><div class="line">lj1g    parameters_LJ_B-B.txt</div><div class="line">3   3   8       7.5     20</div></div><!-- fragment --><p>md_step_limit - лимит шагов МД.</p>
<p>logfilename - имя файла для регулярного вывода энергий и температуры.</p>
<p>init_xyz_filename - имя .xyz файла с начальными расположениями и скоростями атомов.</p>
<p>new_velocities - T или F, присваивать ли атомам новые скорости. Если T, то атомы из группы all_moving_atoms_group_num будут иметь скорости, распределенные по Максвеллу для температуры initial_temerature.</p>
<p>zero_momentum_period - период обнуления скорости центра масс группы атомов all_atoms_group_num. При долгих временах моделирования могут накопиться ошибки. Угловые скорости не обнуляются.</p>
<p>particle_types_num - количество рассматриваемых типов атомов.</p>
<p>groups_num - количество групп атомов. Один атом может входить в несколько групп или не входить ни в одну. Скорее всего понадобится пустая группа.</p>
<p>После groups_num идет таблица с groups_num строками и particle_types_num+1 столбцами. Первый столбец - вспомогательный, рекомендуется писать в него номера строк, они же номера групп. Остальные столбцы - имена атомов.</p>
<p>all_moving_atoms_group_num - номер группы со всеми двигающимися атомами.</p>
<p>xyz_moving_atoms_group_num - номер группы с атомами, двигающимися во всех направлениях</p>
<p>z_moving_atoms_group_num - номер группы с атомами, двигающимися только по оси Z. Группы xyz_moving_atoms_group_num и z_moving_atoms_group_num не должны пересекаться! Термостат не учитывает уменьшение количества степеней свободы для этих атомов!</p>
<p>termo_atoms_group_num - термостатируемая группа атомов.</p>
<p>all_atoms_group_num - группа со всеми моделируемыми атомами.</p>
<p>traj_group_num - группа атомов для вывода положений атомов в один файл каждые period_traj шагов МД.</p>
<p>period_traj - период вывода положений атомов из группы traj_group_num.</p>
<p>change_group_num - количество групп с изменяемым количеством атомов (для добавления атомов в ячейку). См. ???????.</p>
<p>invert_z_vel - T или F, создать или нет абсолютно упругую стенку в верхней части ячейки (для предотвращения прохода атомов через Z границу ячейки)</p>
<p>integrators_num - количество интеграторов.</p>
<p>Далее идет вспомогательная строка.</p>
<p>Далее integrators_num строк с названием интегратора, шагом интегрирования, количеством шагов, периодом вывода положений и скоростей атомов в отдельный файл и периодом вывода в logfilename.</p>
<p>ms_de - разница энергии для остановки молекулярной статики.</p>
<p>nhc_params - параметры цепочки термостатов Нозе-Гувера: температура, количество звеньев и масса первого звена.</p>
<p>initial_temerature - начальная температура группы all_moving_atoms_group_num если в new_velocities указано T.</p>
<p>interactions_num - количество взаимодействий между атомами.</p>
<p>Далее идут interactions_num блоков с параметрами для каждого взаимодействия: название взаимодействия, название файла с параметрами потенциала; в селующих строках - параметры списков соседей.</p>
<p>Список соседей имеет следующие параметры (по порядку): номер первой группы атомов, второй группы атомов, максимальное количество соседей из второй группы для атомов из первой, максимальный радиус включения в список соседей (должен быть меньше радиуса обрезания потенциала и как минимум в два раза меньше минимального размера ячейки), период обновления списка в шагах.</p>
<h4>Файл .xyz с начальными положениями и скоростями атомов.</h4>
<p>Его имя указывается в файле настроек (init_xyz_filename). Также содержит размеры вычислительной ячейки, массы атомов и их названия.</p>
<p>Пример:</p>
<p>4 атома A и 4 атома B с нулевыми скоростями в ячейке 16*16*16 </p><div class="fragment"><div class="line">          8</div><div class="line">Lattice=&quot; 16.0 0.0 0.0 0.0 16.0 0.0 0.0 0.0 16.0 &quot; Properties=pos:R:3:vel:R:3:mass:R:1:species:S:1</div><div class="line">        6.0000000        6.0000000        6.0000000        0.0000000        0.0000000        0.0000000       10.0000000    B</div><div class="line">        6.0000000        6.0000000       10.0000000        0.0000000        0.0000000        0.0000000       10.0000000    B</div><div class="line">        6.0000000       10.0000000        6.0000000        0.0000000        0.0000000        0.0000000       10.0000000    B</div><div class="line">       10.0000000        6.0000000        6.0000000        0.0000000        0.0000000        0.0000000       10.0000000    B</div><div class="line">        0.0000000        0.0000000        0.0000000        0.0000000        0.0000000        0.0000000        1.0000000    A</div><div class="line">        4.0000000        0.0000000        0.0000000        0.0000000        0.0000000        0.0000000        1.0000000    A</div><div class="line">        8.0000000        0.0000000        0.0000000        0.0000000        0.0000000        0.0000000        1.0000000    A</div><div class="line">       12.0000000        0.0000000        0.0000000        0.0000000        0.0000000        0.0000000        1.0000000    A</div></div><!-- fragment --><p>Первая строка - количество атомов.</p>
<p>Вторая строка - размеры ячейки и названия столбцов.</p>
<p>Ячейка задается тремя векторами (в общем случае ячейка триклинная). Пока поддерживается только прямоугольные ячейки. Размер по X - первое число, по Y - пятое, по Z - девятое. Остальные числа - нули.</p>
<p>Типы столбцов используются следующие - Properties=pos:R:3:vel:R:3:mass:R:1:species:S:1. То есть три координаты, три проекции скорости, масса и имя атома (в таком порядке)</p>
<p>С третьей строки идет информация об атомах.</p>
<p>Для генерации ячеек написаны отдельные программы (<a href="https://github.com/AlexanderSidorenkov/xyz_create">https://github.com/AlexanderSidorenkov/xyz_create</a>).</p>
<h4>Файлы с параметрами потенциалов</h4>
<p>См. описания потенциалов взаимодействия.</p>
<h3>Выходная информация и файлы</h3>
<p>Информация в основном потоке вывода.</p>
<p>Лог файл (logfilename).</p>
<p>Конечные значения энергий в общий файл вывода.</p>
<p>Конечные положения и скорости атомов.</p>
<p>Промежуточные положения и скорости атомов, выводимые с периодом указанным в параметрах интегратора.</p>
<p>Промежуточные положения и скорости атомов определенной группы, выводимые в один файл.</p>
<h2>Примеры входных и выходных файлов</h2>
<p>Примеры находятся в папке examples в репозитории <a href="https://github.com/AlexanderSidorenkov/PFMDS_manual">документации</a>.</p>
<h2>Контакты</h2>
<p>e-mail <a href="#" onclick="location.href='mai'+'lto:'+'av.'+'si'+'dor'+'en'+'kov'+'@p'+'hys'+'ic'+'s.m'+'su'+'.ru'; return false;">av.si<span style="display: none;">.nosp@m.</span>dore<span style="display: none;">.nosp@m.</span>nkov@<span style="display: none;">.nosp@m.</span>phys<span style="display: none;">.nosp@m.</span>ics.m<span style="display: none;">.nosp@m.</span>su.r<span style="display: none;">.nosp@m.</span>u</a></p>
<p>github <a href="https://github.com/AlexanderSidorenkov">https://github.com/AlexanderSidorenkov</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
